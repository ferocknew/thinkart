Class ClassCon
	Private v_SQL,v_rs,v_msg,v_err
	'//--------------------------初始函数-------------------------------
	Private Sub Class_Initialize()
		v_err=0
	End Sub
	'//--------------------------析构函数-------------------------------
	Private Sub Class_Terminate()
	End Sub

	'//---------------------------------------------------------
	'添加主分类
	Public Sub AddMaster()
		Dim v_newClassMaster : v_newClassMaster=CheckStr(Easp.RF("newClassMaster",0)) '主分类名
		Dim v_CDate : v_CDate=FormatDT(Now(),"{Y}-{M}-{D} {H}:{N}:{S}")
		Dim v_CDateInt : v_CDateInt=UDate(v_CDate,8)
		Dim v_CUser : v_CUser=Cache("AdminName")

		v_SQL="SELECT * FROM [ContentClass]"
		Set v_rs = Server.CreateObject("ADODB.RecordSet")
		Call v_rs.Open(v_SQL,Conn,1,3)
		v_rs.addnew
		v_rs("ClassName")=v_newClassMaster
		v_rs("CDate")=v_CDate
		v_rs("CDateInt")=v_CDateInt
		v_rs("CUser")=v_CUser
		v_rs("MDate")=v_CDate
		v_rs("MDateInt")=v_CDateInt
		v_rs("MUser")=v_CUser
		v_rs.update
		v_rs.close:Set v_rs=Nothing
		v_msg="添加成功！"

		Call jsonheadResponse()
		Call Jasp.output(Jasp.parse("{""err"":"&v_err&",""msg"":"""&v_msg&"""}").Get(),"json")
	End Sub

	'//---------------------------------------------------------
	'Show List
	Public Function getMasterList(ByVal v_item)
		If Not Conn.Execute("SELECT COUNT(*) From [ContentClass] WHERE UpClassId=0 AND IsHide=0")(0)=0 Then
			Set v_rs=Conn.Execute("SELECT "&v_item&" From [ContentClass] WHERE UpClassId=0 AND IsHide=0 ORDER BY SortIndex,MDateInt ASC")
			getMasterList=v_rs.getRows()
		Else
			getMasterList=Empty
		End If
	End Function
End Class